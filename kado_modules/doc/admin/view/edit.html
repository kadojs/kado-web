{{>header}}
    <div class="container-fluid">
      <h1>{{_l.update}} Doc</h1>
      <form class="form form-horizontal" action="{{_u._doc_save}}" method="post" role="form">
        <input type="hidden" name="id" value="{{item.id}}" />
        <input type="hidden" name="DocProjectVersionId" value="{{item.DocProjectVersionId}}" />
        <input type="hidden" id="docContentInput" name="content" />
        <input type="hidden" id="docHtmlInput" name="html" />
        <div class="form-group">
          <label for="title">Title</label>
          <input class="form-control" type="text" id="title" name="title" placeholder="Title" value="{{item.title}}" />
        </div>
        <div class="form-group">
          <label for="title">Uri</label>
          <input class="form-control" type="text" id="uri" name="uri" placeholder="Uri" value="{{item.uri}}" />
        </div>
        <div class="form-group">
          <label for="docContent">Content</label>
          <div id="docContent"></div>
        </div>
        <div class="form-group">
          <button class="btn btn-success" id="docSave" type="submit">Save</button>
        </div>
      </form>
      <script type="text/javascript">
        $(document).ready(() => {
          let uriEl = $('#docUri')
          let titleEl = $('#docTitle')
          let uriEmpty = uriEl.val() === ''
          let updateUri = () => {
            let title = titleEl.val()
            let uri = title.replace(/[\s]+/g,'-').toLowerCase()
            if(uriEmpty) uriEl.val(uri)
          }
          titleEl.keyup(updateUri)
          titleEl.change(updateUri)
          titleEl.focusout(updateUri)
        })
      </script>
      <script type="text/javascript" src='/node_modules/markdown-it/dist/markdown-it.min.js'></script>
      <script type="text/javascript" src="/node_modules/to-mark/dist/to-mark.min.js"></script>
      <script type="text/javascript" src="/node_modules/codemirror/lib/codemirror.js"></script>
      <script type="text/javascript" src="/node_modules/highlight.js/lib/highlight.js"></script>
      <script type="text/javascript" src="/node_modules/squire-rte/build/squire-raw.js"></script>
      <script type="text/javascript" src="/node_modules/tui-code-snippet/dist/tui-code-snippet.min.js"></script>
      <script type="text/javascript" src="/node_modules/tui-editor/dist/tui-editor-Editor.js"></script>
      <script type="text/javascript">
        $(document).ready(() => {
          let editor = new tui.Editor({
            el: document.querySelector('#docContent'),
            initialEditType: 'markdown',
            previewStyle: 'vertical',
            height: '400px',
            codeBlockLanguages: ['ruby', 'PHP', 'javascript'],
            initialValue: decodeURIComponent('{{item.content}}'),
            events: {
              change: () => {
                $('#docContentInput').val(editor.getMarkdown())
                $('#docHtmlInput').val(editor.getHtml())
              }
            }
          })
        })
      </script>
      <link rel="stylesheet" type="text/css" href="/node_modules/tui-editor/dist/tui-editor.css" />
      <link rel="stylesheet" type="text/css" href="/node_modules/tui-editor/dist/tui-editor-contents.css" />
      <link rel="stylesheet" type="text/css" href="/node_modules/codemirror/lib/codemirror.css">
      <link rel="stylesheet" type="text/css" href="/node_modules/highlight.js/styles/github.css">
    </div>
{{>footer}}
